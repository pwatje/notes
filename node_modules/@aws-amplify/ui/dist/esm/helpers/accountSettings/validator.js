import{__spreadArray as e}from"tslib";import{Amplify as t}from"aws-amplify";import"lodash/includes";import"../../types/authenticator/user.js";import"../../types/authenticator/attributes.js";import"../../types/primitives/componentClassName.js";import"../../i18n/translations.js";import{hasSpecialChars as r}from"../authenticator/utils.js";import"lodash/cloneDeep";var a=function(){var e=t.configure(),r=null==e?void 0:e.aws_cognito_password_protection_settings;if(!r)return null;var a=r.passwordPolicyCharacters,n=void 0===a?[]:a;return{minLength:r.passwordPolicyMinLength,needsLowerCase:n.includes("REQUIRES_LOWERCASE"),needsUpperCase:n.includes("REQUIRES_UPPERCASE"),needsNumber:n.includes("REQUIRES_NUMBERS"),needsSpecialChar:n.includes("REQUIRES_SYMBOLS")}},n=function(e){return{validationMode:"onTouched",validator:function(t){return t.length>=e},message:"Password must have at least ".concat(e," characters")}},s={validationMode:"onTouched",validator:function(e){return/[a-z]/.test(e)},message:"Password must have lower case letters"},o={validationMode:"onTouched",validator:function(e){return/[A-Z]/.test(e)},message:"Password must have upper case letters"},i={validationMode:"onTouched",validator:function(e){return/[0-9]/.test(e)},message:"Password must have numbers"},u={validationMode:"onTouched",validator:function(e){return r(e)},message:"Password must have special characters"},d=function(e){return{validationMode:"onTouched",validator:function(t){return e===t},message:"Your passwords must match"}},c=function(){var e=a();if(!e)return[];var t=[],r=e.minLength,d=e.needsLowerCase,c=e.needsUpperCase,l=e.needsNumber,p=e.needsSpecialChar;return r&&t.push(n(r)),d&&t.push(s),c&&t.push(o),l&&t.push(i),p&&t.push(u),t},l=function(e){return[d(e)]},p=function(e){var t=e.validationMode,r=e.eventType,a=e.hasBlurred;switch(t){case"onBlur":return"blur"===r;case"onChange":return"change"===r;case"onTouched":return"blur"===r||a}},h=function(t){var r=t.value,a=t.validators,n=t.eventType,s=t.hasBlurred;return r?a.reduce((function(t,a){var o=a.validator,i=a.validationMode,u=a.message;if(p({validationMode:i,eventType:n,hasBlurred:s}))return!o(r)?e(e([],t,!0),[u],!1):t}),[]):[]};export{l as getDefaultConfirmPasswordValidators,c as getDefaultPasswordValidators,n as getHasMinLength,d as getMatchesConfirmPassword,a as getPasswordRequirement,s as hasLowerCase,i as hasNumber,u as hasSpecialChar,o as hasUpperCase,h as runFieldValidators,p as shouldValidate};
