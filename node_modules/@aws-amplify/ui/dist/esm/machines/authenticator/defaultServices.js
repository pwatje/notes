import{__awaiter as t,__generator as n,__assign as r}from"tslib";import{Amplify as i,Auth as o}from"aws-amplify";import"lodash/includes";import"../../types/authenticator/user.js";import"../../types/authenticator/attributes.js";import"../../types/primitives/componentClassName.js";import"../../i18n/translations.js";import{hasSpecialChars as s}from"../../helpers/authenticator/utils.js";import"lodash/cloneDeep";import"../../helpers/accountSettings/utils.js";var e={getAmplifyConfig:function(){return t(this,void 0,void 0,(function(){return n(this,(function(t){return[2,i.configure()]}))}))},getCurrentUser:function(){return t(this,void 0,void 0,(function(){return n(this,(function(t){return[2,o.currentAuthenticatedUser()]}))}))},handleSignUp:function(i){return t(this,void 0,void 0,(function(){return n(this,(function(t){return[2,o.signUp(r(r({},i),{autoSignIn:{enabled:!0}}))]}))}))},handleSignIn:function(r){var i=r.username,s=r.password;return t(this,void 0,void 0,(function(){return n(this,(function(t){return[2,o.signIn(i,s)]}))}))},handleConfirmSignIn:function(r){var i=r.user,s=r.code,e=r.mfaType;return t(this,void 0,void 0,(function(){return n(this,(function(t){return[2,o.confirmSignIn(i,s,e)]}))}))},handleConfirmSignUp:function(r){var i=r.username,s=r.code;return t(this,void 0,void 0,(function(){return n(this,(function(t){switch(t.label){case 0:return[4,o.confirmSignUp(i,s)];case 1:return[2,t.sent()]}}))}))},handleForgotPasswordSubmit:function(r){var i=r.username,s=r.code,e=r.password;return t(this,void 0,void 0,(function(){return n(this,(function(t){return[2,o.forgotPasswordSubmit(i,s,e)]}))}))},handleForgotPassword:function(r){return t(this,void 0,void 0,(function(){return n(this,(function(t){return[2,o.forgotPassword(r)]}))}))},validateCustomSignUp:function(r,i){return t(this,void 0,void 0,(function(){return n(this,(function(t){return[2]}))}))},validateFormPassword:function(r,i,o){return t(this,void 0,void 0,(function(){var t,e,u,a;return n(this,(function(n){return t=r.password,i.password&&o?(e=[],u=+(null==o?void 0:o.passwordPolicyMinLength),t.length<u&&e.push("Password must have at least ".concat(u," characters")),null==(a=null==o?void 0:o.passwordPolicyCharacters)||a.forEach((function(n){switch(n){case"REQUIRES_LOWERCASE":/[a-z]/.test(t)||e.push("Password must have lower case letters");break;case"REQUIRES_UPPERCASE":/[A-Z]/.test(t)||e.push("Password must have upper case letters");break;case"REQUIRES_NUMBERS":/[0-9]/.test(t)||e.push("Password must have numbers");break;case"REQUIRES_SYMBOLS":s(t)||e.push("Password must have special characters")}})),[2,0!==e.length?{password:e}:null]):[2,null]}))}))},validateConfirmPassword:function(r,i){return t(this,void 0,void 0,(function(){var t,o,s,e;return n(this,(function(n){return t=r.password,o=r.confirm_password,s=i.confirm_password,e=i.password,t||o?(t||o)&&t!==o&&(s&&e||(null==t?void 0:t.length)>=6&&(null==o?void 0:o.length)>=6)?[2,{confirm_password:"Your passwords must match"}]:[2]:[2,null]}))}))},validatePreferredUsername:function(r,i){return t(this,void 0,void 0,(function(){return n(this,(function(t){return[2]}))}))}};export{e as defaultServices};
